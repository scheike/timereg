<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-02-26 Sun 16:55 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Twin analysis</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Klaus Holst &amp; Thomas Scheike" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="orgmode5-ts.css">
<style type="text/css">
a.logo span { background: none; }
th,td,tr,table th,table th,table td {
background: rgba(240,240,240,1);
border: none;
}
body { width: 800px; text-align:justify; text-justify:inter-word; }
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">

<script type="text/javascript">
  function swapStyleSheet(sheet){
      document.getElementById('pagestyle').setAttribute('href', sheet);
  }
  document.addEventListener('DOMContentLoaded',function() {
      document.getElementById('content').onclick = function() {
          var elem = document.getElementById('text-table-of-contents');
          elem.style.display = elem.style.display == 'block' ? 'none' : 'block';
      }
  });
  document.addEventListener('DOMContentLoaded',function() {
      document.getElementById('content').onclick = function() {
          var elem = document.getElementsByClassName('nav');
          for (i = 0; i < elem.length; i++) { 
               elem[i].style.display = elem[i].style.display == 'block' ? 'none' : 'block';
          }
      }
  });
</script>
</div>
<div id="content">
<h1 class="title">Twin analysis</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgbc82716">Mets package</a></li>
<li><a href="#org6911d0e">Twin analysis, continuous traits</a>
<ul>
<li><a href="#org06d6e52">Polygenic model</a></li>
</ul>
</li>
<li><a href="#org6fea32a">Twin analysis, censored outcomes</a></li>
<li><a href="#org6e72be4">Twin analysis,  binary traits</a></li>
<li><a href="#org40d3456">Time to event</a></li>
</ul>
</div>
</div>
\(
\newcommand{\cov}{\mathbb{C}\text{ov}}
\newcommand{\cor}{\mathbb{C}\text{or}}
\newcommand{\var}{\mathbb{V}\text{ar}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\unitfrac}[2]{#1/#2}
\newcommand{\n}{}
\)
<hr />

<div id="outline-container-orgbc82716" class="outline-2">
<h2 id="orgbc82716">Mets package</h2>
<div class="outline-text-2" id="text-orgbc82716">
<p>
This document provides a brief tutorial to analyzing twin data using
the <b><code>mets</code></b> package:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #268bd2; font-weight: bold;">library</span>(<span style="color: #2aa198;">"mets"</span>)
options(warn=-1)
</pre>
</div>

<p>
The development version may be installed from <i>github</i>, i.e., with the
<code>devtools</code> package:
</p>
<div class="org-src-container">
<pre class="src src-R">devtools::install_github(<span style="color: #2aa198;">"kkholst/lava"</span>)
devtools::install_github(<span style="color: #2aa198;">"kkholst/mets"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6911d0e" class="outline-2">
<h2 id="org6911d0e">Twin analysis, continuous traits</h2>
<div class="outline-text-2" id="text-org6911d0e">
<p>
  In the following we examine the heritability of Body Mass Index\n{}<a class='org-ref-reference' href="#korkeila_bmi_1991">korkeila_bmi_1991</a> <a class='org-ref-reference' href="#hjelmborg_bmi_2008">hjelmborg_bmi_2008</a>, based on
data on self-reported BMI-values from a random sample of 11,411 same-sex twins. First, we will load data
</p>

<div class="org-src-container">
<pre class="src src-R">data(<span style="color: #2aa198;">"twinbmi"</span>)
head(twinbmi)
</pre>
</div>

<pre class="example">
         tvparnr      bmi      age gender zyg
100001.1  100001 26.33289 57.57974   male  DZ
100002.1  100002 28.65014 57.04860   male  MZ
100003.1  100003 28.40909 57.67830   male  DZ
100004.1  100004 27.25089 53.51677   male  DZ
100005.1  100005 27.77778 52.57495   male  DZ
100006.1  100006 28.04282 52.57221   male  DZ
</pre>

<p>
The data is on <i>long</i> format with one subject per row.
</p>
<div class="mnote">
<dl class="org-dl">
<dt><b><code>tvparnr</code></b></dt><dd>twin id</dd>
<dt><b><code>bmi</code></b></dt><dd>Body Mass Index (\(\unitfrac{kg}{m^2}\))</dd>
<dt><b><code>age</code></b></dt><dd>Age (years)</dd>
<dt><b><code>gender</code></b></dt><dd>Gender factor (male,female)</dd>
<dt><b><code>zyg</code></b></dt><dd>zygosity (MZ,DZ)</dd>
</dl>

</div>


<p>
we transpose the data allowing us to do pairwise analyses
</p>
<div class="org-src-container">
<pre class="src src-R">twinwide <span style="color: #268bd2; font-weight: bold;">&lt;-</span> fast.reshape(twinbmi, id=<span style="color: #2aa198;">"tvparnr"</span>,varying=c(<span style="color: #2aa198;">"bmi"</span>))
head(twinwide)
</pre>
</div>

<pre class="example">
         tvparnr     bmi1      age gender zyg     bmi2
100001.1  100001 26.33289 57.57974   male  DZ 25.46939
100002.1  100002 28.65014 57.04860   male  MZ       NA
100003.1  100003 28.40909 57.67830   male  DZ       NA
100004.1  100004 27.25089 53.51677   male  DZ 28.07504
100005.1  100005 27.77778 52.57495   male  DZ       NA
100006.1  100006 28.04282 52.57221   male  DZ 22.30936
</pre>

<p>
Next we plot the association within each zygosity group
</p>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #268bd2; font-weight: bold;">library</span>(<span style="color: #2aa198;">"cowplot"</span>)

<span style="color: #268bd2;">scatterdens</span> <span style="color: #268bd2; font-weight: bold;">&lt;-</span> <span style="color: #859900; font-weight: bold;">function</span>(x) {    
    sp <span style="color: #268bd2; font-weight: bold;">&lt;-</span> ggplot(x,  
                aes_string(colnames(x)[1], colnames(x)[2])) +
        theme_minimal() +
        geom_point(alpha=0.3) + geom_density_2d()
    xdens <span style="color: #268bd2; font-weight: bold;">&lt;-</span> ggplot(x, aes_string(colnames(x)[1],fill=1)) + 
        theme_minimal() +
        geom_density(alpha=.5)+ 
        theme(axis.text.x = element_blank(),
              legend.position = <span style="color: #2aa198;">"none"</span>) + labs(x=<span style="color: #b58900;">NULL</span>)
    ydens <span style="color: #268bd2; font-weight: bold;">&lt;-</span> ggplot(x, aes_string(colnames(x)[2],fill=1)) +
        theme_minimal() +
        geom_density(alpha=.5) +
        theme(axis.text.y = element_blank(),
              axis.text.x = element_text(angle=90, vjust=0),
              legend.position = <span style="color: #2aa198;">"none"</span>) +
        labs(x=<span style="color: #b58900;">NULL</span>) +
        coord_flip()
    g <span style="color: #268bd2; font-weight: bold;">&lt;-</span> plot_grid(xdens,<span style="color: #b58900;">NULL</span>,sp,ydens,
                  ncol=2,nrow=2,
                  rel_widths=c(4,1.4),rel_heights=c(1.4,4))    
    <span style="color: #859900; font-weight: bold;">return</span>(g)
}
</pre>
</div>

<p>
We here show the log-transformed data which is slightly more symmetric
and more appropiate for the twin analysis (see Figure <a href="#fig:scatter1">fig:scatter1</a> and <a href="#fig:scatter2">fig:scatter2</a>)
</p>
<div class="org-src-container">
<pre class="src src-R" id="org3b6bab6">mz <span style="color: #268bd2; font-weight: bold;">&lt;-</span> log(subset(twinwide, zyg==<span style="color: #2aa198;">"MZ"</span>)[,c(<span style="color: #2aa198;">"bmi1"</span>,<span style="color: #2aa198;">"bmi2"</span>)])
scatterdens(mz)
</pre>
</div>

<div class="marginfigure">

<div class="figure">
<p><img src="fig/scatter1.png" alt="scatter1.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Scatter plot of logarithmic BMI measurements in MZ twins  <div id="fig:scatter1"></p>
</div>

</div>


<div class="org-src-container">
<pre class="src src-R" id="org2e715da">dz <span style="color: #268bd2; font-weight: bold;">&lt;-</span> log(subset(twinwide, zyg==<span style="color: #2aa198;">"DZ"</span>)[,c(<span style="color: #2aa198;">"bmi1"</span>,<span style="color: #2aa198;">"bmi2"</span>)])
scatterdens(dz)
</pre>
</div>

<div class="marginfigure">

<div class="figure">
<p><img src="fig/scatter2.png" alt="scatter2.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Scatter plot of logarithmic BMI measurements in DZ twins. <div id="fig:scatter2"></p>
</div>

</div>

<p>
The plots and raw association measures shows considerable stronger
dependence in the MZ twins, thus indicating genetic influence of the
trait
</p>
<div class="org-src-container">
<pre class="src src-R">cor.test(mz[,1],mz[,2], method=<span style="color: #2aa198;">"spearman"</span>)
</pre>
</div>

<pre class="example">
	Spearman's rank correlation rho

data:  mz[, 1] and mz[, 2]
S = 165460000, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.6956209
</pre>

<div class="org-src-container">
<pre class="src src-R">cor.test(dz[,1],dz[,2], method=<span style="color: #2aa198;">"spearman"</span>)
</pre>
</div>

<pre class="example">
	Spearman's rank correlation rho

data:  dz[, 1] and dz[, 2]
S = 2162500000, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.4012686
</pre>

<p>
Åƒext we examine the marginal distribution (GEE model with working
independence)
</p>

<div class="org-src-container">
<pre class="src src-R">l0 <span style="color: #268bd2; font-weight: bold;">&lt;-</span> lm(bmi ~ gender + I(age-40), data=twinbmi)
estimate(l0, id=twinbmi$tvparnr)
</pre>
</div>

<pre class="example">
            Estimate Std.Err   2.5%  97.5%   P-value
(Intercept)   23.369 0.05453 23.262 23.476  0.00e+00
gendermale     1.407 0.07322  1.264  1.551  2.35e-82
I(age - 40)    0.118 0.00479  0.108  0.127 2.00e-133
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #268bd2; font-weight: bold;">library</span>(<span style="color: #2aa198;">"splines"</span>)
l1 <span style="color: #268bd2; font-weight: bold;">&lt;-</span> lm(bmi ~ gender*ns(age,3), data=twinbmi)
marg1 <span style="color: #268bd2; font-weight: bold;">&lt;-</span> estimate(l1, id=twinbmi$tvparnr)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R" id="org851e584">dm <span style="color: #268bd2; font-weight: bold;">&lt;-</span> Expand(twinbmi,
            bmi=0,
            gender=c(<span style="color: #2aa198;">"male"</span>),
            age=seq(33,61,length.out=50))
df <span style="color: #268bd2; font-weight: bold;">&lt;-</span> Expand(twinbmi,
            bmi=0,
            gender=c(<span style="color: #2aa198;">"female"</span>),
            age=seq(33,61,length.out=50))

plot(marg1, <span style="color: #859900; font-weight: bold;">function</span>(p) model.matrix(l1,data=dm)<span style="color: #268bd2; font-weight: bold;">%*%</span>p, 
     data=dm[<span style="color: #2aa198;">"age"</span>], ylab=<span style="color: #2aa198;">"BMI"</span>, xlab=<span style="color: #2aa198;">"Age"</span>,
     ylim=c(22,26.5))
plot(marg1, <span style="color: #859900; font-weight: bold;">function</span>(p) model.matrix(l1,data=df)<span style="color: #268bd2; font-weight: bold;">%*%</span>p,  
     data=df[<span style="color: #2aa198;">"age"</span>], col=<span style="color: #2aa198;">"red"</span>, add=<span style="color: #b58900;">TRUE</span>)
legend(<span style="color: #2aa198;">"bottomright"</span>, c(<span style="color: #2aa198;">"Male"</span>,<span style="color: #2aa198;">"Female"</span>), 
       col=c(<span style="color: #2aa198;">"black"</span>,<span style="color: #2aa198;">"red"</span>), lty=1, bty=<span style="color: #2aa198;">"n"</span>)
</pre>
</div>


<div class="marginfigure">

<div class="figure">
<p><img src="fig/marg1.png" alt="marg1.png" />
</p>
<p><span class="figure-number">Figure 3: </span>&#x2026; <div id="fig:marg1"></p>
</div>

</div>
</div>

<div id="outline-container-org06d6e52" class="outline-3">
<h3 id="org06d6e52">Polygenic model</h3>
<div class="outline-text-3" id="text-org06d6e52">
<p>
Decompose outcome into
</p>
\begin{align*}
Y_i = A_i + D_i + C + E_i, \quad i=1,2
 \end{align*}

<dl class="org-dl">
<dt>\(A\)</dt><dd>Additive genetic effects of alleles</dd>
<dt>\(D\)</dt><dd>Dominante genetic effects of alleles</dd>
<dt>\(C\)</dt><dd>Shared environmental effects</dd>
<dt>\(E\)</dt><dd>Unique environmental genetic effects</dd>
</dl>

<p>
Dissimilarity of MZ twins arises from unshared environmental effects
only! \(\cor(E_1,E_2)=0\) and
</p>
\begin{align*}
\cor(A_1^{MZ},A_2^{MZ}) = 1, \quad 
\cor(D_1^{MZ},D_2^{MZ}) = 1,
\end{align*}
\begin{align*}
\cor(A_1^{DZ},A_2^{DZ}) = 0.5, \quad
\cor(D_1^{DZ},D_2^{DZ}) = 0.25,
\end{align*}

\begin{align*}
Y_i = A_i + C_i + D_i + E_i
\end{align*}
\begin{align*}
A_i \sim\mathcal{N}(0,\sigma_A^2), C_i
\sim\mathcal{N}(0,\sigma_C^2), D_i
\sim\mathcal{N}(0,\sigma_D^2),
E_i \sim\mathcal{N}(0,\sigma_E^2)
\end{align*}

  \begin{gather*}
    \cov(Y_{1},Y_{2}) = \\
    \begin{pmatrix}
      \sigma_A^2 & 2\Phi\sigma_A^2 \\
      2\Phi\sigma_A^2 & \sigma_A^2
    \end{pmatrix} + 
    \begin{pmatrix}
      \sigma_C^2 & \sigma_C^2 \\
      \sigma_C^2 & \sigma_C^2      
  \end{pmatrix} +
    \begin{pmatrix}
      \sigma_D^2 & \Delta_{7}\sigma_D^2 \\
      \Delta_{7}\sigma_D^2 & \sigma_D^2      
  \end{pmatrix} +
  \begin{pmatrix}
    \sigma_E^2 & 0 \\
    0 & \sigma_E^2      
  \end{pmatrix}
\end{gather*}



<div class="org-src-container">
<pre class="src src-R">dd <span style="color: #268bd2; font-weight: bold;">&lt;-</span> na.omit(twinbmi)
l0 <span style="color: #268bd2; font-weight: bold;">&lt;-</span> twinlm(bmi ~ age+gender, data=dd, 
            DZ=<span style="color: #2aa198;">"DZ"</span>, zyg=<span style="color: #2aa198;">"zyg"</span>, id=<span style="color: #2aa198;">"tvparnr"</span>, type=<span style="color: #2aa198;">"sat"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">l <span style="color: #268bd2; font-weight: bold;">&lt;-</span> twinlm(bmi ~ ns(age,1)+gender, data=twinbmi, 
           DZ=<span style="color: #2aa198;">"DZ"</span>, zyg=<span style="color: #2aa198;">"zyg"</span>, id=<span style="color: #2aa198;">"tvparnr"</span>, type=<span style="color: #2aa198;">"cor"</span>, missing=<span style="color: #b58900;">TRUE</span>)
summary(l)
</pre>
</div>

<pre class="example">
____________________________________________________
Group 1
                        Estimate Std. Error   Z value Pr(&gt;|z|)
Regressions:                                                  
   bmi.1~ns(age, 1).1    4.08914    0.16354  25.00328   &lt;1e-12
   bmi.1~gendermale.1    1.41143    0.07285  19.37536   &lt;1e-12
Intercepts:                                                   
   bmi.1                22.57414    0.07187 314.08431   &lt;1e-12
Additional Parameters:                                        
   log(var)              2.44584    0.01425 171.68385   &lt;1e-12
   atanh(rhoMZ)          0.78216    0.02290  34.15832   &lt;1e-12
____________________________________________________
Group 2
                        Estimate Std. Error   Z value Pr(&gt;|z|)
Regressions:                                                  
   bmi.1~ns(age, 1).1    4.08914    0.16354  25.00328   &lt;1e-12
   bmi.1~gendermale.1    1.41143    0.07285  19.37536   &lt;1e-12
Intercepts:                                                   
   bmi.1                22.57414    0.07187 314.08431   &lt;1e-12
Additional Parameters:                                        
   log(var)              2.44584    0.01425 171.68385   &lt;1e-12
   atanh(rhoDZ)          0.29927    0.01848  16.19766   &lt;1e-12

                       Estimate 2.5%    97.5%  
Correlation within MZ: 0.65394  0.62750 0.67888
Correlation within DZ: 0.29064  0.25715 0.32344

'log Lik.' -29020.35 (df=6)
AIC: 58052.71 
BIC: 58093.76
</pre>

<p>
A formal test of genetic effects can be obtained by comparing the MZ and DZ correlation:
</p>
<div class="org-src-container">
<pre class="src src-R">estimate(l,contr(5:6,6))
</pre>
</div>

<pre class="example">
                          Estimate Std.Err  2.5% 97.5% P-value
[1@atanh(rhoMZ)] - [4....    0.483  0.0418 0.401 0.565 6.4e-31

 Null Hypothesis: 
  [1@atanh(rhoMZ)] - [4@atanh(rhoDZ)] = 0
</pre>


<div class="org-src-container">
<pre class="src src-R">l <span style="color: #268bd2; font-weight: bold;">&lt;-</span> twinlm(bmi ~ ns(age,1)+gender, data=twinbmi, 
           DZ=<span style="color: #2aa198;">"DZ"</span>, zyg=<span style="color: #2aa198;">"zyg"</span>, id=<span style="color: #2aa198;">"tvparnr"</span>, type=<span style="color: #2aa198;">"cor"</span>, missing=<span style="color: #b58900;">TRUE</span>)
summary(l)
</pre>
</div>

<pre class="example">
____________________________________________________
Group 1
                        Estimate Std. Error   Z value Pr(&gt;|z|)
Regressions:                                                  
   bmi.1~ns(age, 1).1    4.08914    0.16354  25.00328   &lt;1e-12
   bmi.1~gendermale.1    1.41143    0.07285  19.37536   &lt;1e-12
Intercepts:                                                   
   bmi.1                22.57414    0.07187 314.08431   &lt;1e-12
Additional Parameters:                                        
   log(var)              2.44584    0.01425 171.68385   &lt;1e-12
   atanh(rhoMZ)          0.78216    0.02290  34.15832   &lt;1e-12
____________________________________________________
Group 2
                        Estimate Std. Error   Z value Pr(&gt;|z|)
Regressions:                                                  
   bmi.1~ns(age, 1).1    4.08914    0.16354  25.00328   &lt;1e-12
   bmi.1~gendermale.1    1.41143    0.07285  19.37536   &lt;1e-12
Intercepts:                                                   
   bmi.1                22.57414    0.07187 314.08431   &lt;1e-12
Additional Parameters:                                        
   log(var)              2.44584    0.01425 171.68385   &lt;1e-12
   atanh(rhoDZ)          0.29927    0.01848  16.19766   &lt;1e-12

                       Estimate 2.5%    97.5%  
Correlation within MZ: 0.65394  0.62750 0.67888
Correlation within DZ: 0.29064  0.25715 0.32344

'log Lik.' -29020.35 (df=6)
AIC: 58052.71 
BIC: 58093.76
</pre>
</div>
</div>
</div>


<div id="outline-container-org6fea32a" class="outline-2">
<h2 id="org6fea32a">Twin analysis, censored outcomes</h2>
</div>

<div id="outline-container-org6e72be4" class="outline-2">
<h2 id="org6e72be4">Twin analysis,  binary traits</h2>
</div>


<div id="outline-container-org40d3456" class="outline-2">
<h2 id="org40d3456">Time to event</h2>
</div>



<p>
<h1 class='org-ref-bib-h1'>Bibliography</h1>
<ul class='org-ref-bib'><li><a id="korkeila_bmi_1991">[korkeila_bmi_1991] "Korkeila, Kaprio, Rissanen & Koskenvuo, Effects of gender and age on the heritability of body mass index, <i>"Int J Obes"</i>, <b>15(10)</b>, 647-654 (1991).</a></li>
<li><a id="hjelmborg_bmi_2008">[hjelmborg_bmi_2008] "Hjelmborg, Fagnani, Silventoinen, McGue, Korkeila, Christensen, Rissanen & Kaprio, Genetic influences on growth traits of BMI: a longitudinal study of adult twins, <i>"Obesity (Silver Spring)"</i>, <b>16(4)</b>, 847-852 (2008).</a></li>
</ul>

</p>
</div>
<div id="postamble" class="status">
<p class="author">Author: Klaus Holst &amp; Thomas Scheike</p>
<p class="date">Created: 2017-02-26 Sun 16:55</p>
<p class="validation"></p>
</div>
</body>
</html>
